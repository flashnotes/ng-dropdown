angular.module("ng-dropdown",[]).factory("DropdownService",function(){return{element:null,menuElement:null}}).directive("dropdown",["$document","$parse","DropdownService",function(e,n,d){return{restrict:"A",scope:{disabled:"&dropdownDisabled",opened:"@"},link:function(n,o,t){function l(){n.$apply(function(){d.menuElement.addClass(u),d.element.addClass(p),n.opened=!0})}function a(){n.$apply(function(){d.menuElement.removeClass(u),d.element.removeClass(p),n.opened=!1})}function i(){n.opened?a():l()}var r=o[0].querySelector(".ng-dropdown-field"),u=t.dropdownOpenClass||"open",p=(t.dropdownOptionClass||"option",t.dropdownActiveClass||"active");n.opened=!1,n.$watch("disabled()",function(e){e?o.addClass("dropdown-disabled"):o.removeClass("dropdown-disabled")}),o.bind("click",function(e){if(!n.disabled()){var l=angular.element(document.getElementById(t.dropdownMenu));d.menuElement&&d.menuElement.attr("id")!==l.attr("id")&&a(),d.menuElement=l,d.element=o,e.preventDefault(),e.stopPropagation(),i()}}),e.bind("keyup",function(e){n.disabled()||!n.opened&&document.activeElement!==r||(27===e.keyCode||9===e.keyCode?a():40===e.keyCode||38===e.keyCode||13===e.keyCode&&document.activeElement===r&&(d.element=o,d.menuElement=angular.element(document.getElementById(t.dropdownMenu)),l()))}),e.bind("click",function(){n.opened&&event.target!==openTarget&&a()})}}}]);